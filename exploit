#!/usr/bin/env python3

import requests, os, sys, socket, time, art, ipaddress, random
from colorama import Fore
from tqdm import trange
from urllib.parse import urlparse

def load():
    time.sleep(0.1)

def get_ip(url):
    # get ip
    hostname = socket.gethostbyname(urlparse(url).hostname)
    print(hostname)
    if hostname:
        return ipaddress.IPv4Address(hostname).is_private

def load():
    time.sleep(0.1)

def main():
    # banner
    banner = art.text2art("exploit", font="small")
    list = [Fore.BLUE,Fore.YELLOW,Fore.LIGHTCYAN_EX,Fore.CYAN,Fore.GREEN,Fore.MAGENTA,Fore.RED]
    rand = random.choice(list)
    print(f"{rand}{banner}")
    
    # load
    for i in trange(20):
        load()
    print()
    
    # get request
    r = requests.get(sys.argv[1])
    exit = lambda: sys.exit()
    
    # loop
    while True:
        # shell
        rand = random.choice(list)
        shell = input(f"{rand}shell:~$ ")
        
        # commands
        if shell == "request":
            print(r)
        elif shell == "status_code":
            print(r.status_code)
        elif shell == "url":
            print(r.url)
        elif shell == "ip":
            get_ip(sys.argv[1])
        elif "payload" in shell:
            payload = shell.split(" ")
            print(payload)
            r = requests.get(sys.argv[1], params=payload)
        elif shell == "history":
            print(r.history)
        elif shell == "content":
            print(r.content)
        elif "post" in shell:
            data = shell.split(" ")
            r = requests.post(sys.argv[1], data=data)
        elif shell == "encoding":
            print(r.encoding)
        elif shell == "cookies":
            print(r.cookies)
        elif shell == "headers":
            print(r.headers)
        elif shell == "text":
            print(r.text)
        elif shell == "exit":
            exit()
        elif shell == "json":
            print(r.json)
        elif shell == "clear":
            os.system("clear")
        else:
            os.system(shell)

main()
